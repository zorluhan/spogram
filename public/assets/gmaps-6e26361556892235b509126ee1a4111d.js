function gmaps_init(){var e=new google.maps.LatLng(51.751724,-1.255284),o={zoom:2,center:e,mapTypeId:google.maps.MapTypeId.ROADMAP};map=new google.maps.Map(document.getElementById("gmaps-canvas"),o),geocoder=new google.maps.Geocoder,marker=new google.maps.Marker({map:map,draggable:!0}),google.maps.event.addListener(marker,"dragend",function(){geocode_lookup("latLng",marker.getPosition())}),google.maps.event.addListener(map,"click",function(e){marker.setPosition(e.latLng),geocode_lookup("latLng",e.latLng)}),$("#gmaps-error").hide()}function update_map(e){map.fitBounds(e.viewport),marker.setPosition(e.location)}function update_ui(e,o){$(".gmapsinput").autocomplete("close"),$(".gmapsinput").val(e)}function geocode_lookup(e,o,a){a="undefined"!=typeof a?a:!1,request={},request[e]=o,geocoder.geocode(request,function(t,r){$("#gmaps-error").html(""),$("#gmaps-error").hide(),r==google.maps.GeocoderStatus.OK?t[0]?(update_ui(t[0].formatted_address,t[0].geometry.location),a&&update_map(t[0].geometry)):($("#gmaps-error").html("Sorry, something went wrong. Try again!"),$("#gmaps-error").show()):"address"==e?($("#gmaps-error").html("Sorry! We couldn't find "+o+". Try a different search term, or click the map."),$("#gmaps-error").show()):($("#gmaps-error").html("Woah... that's pretty remote! You're going to have to manually enter a place name."),$("#gmaps-error").show(),update_ui("",o))})}function autocomplete_init(){$(".gmapsinput").autocomplete({source:function(e,o){geocoder.geocode({address:e.term},function(e,a){o($.map(e,function(e){return{label:e.formatted_address,value:e.formatted_address,geocode:e}}))})},select:function(e,o){update_ui(o.item.value,o.item.geocode.geometry.location),update_map(o.item.geocode.geometry)}}),$(".gmapsinput").bind("keydown",function(e){13==e.keyCode?(geocode_lookup("address",$(".gmapsinput").val(),!0),$(".gmapsinput").autocomplete("disable")):$(".gmapsinput").autocomplete("enable")})}var geocoder,map,marker;$(document).ready(function(){$("#gmaps-canvas").length&&(gmaps_init(),autocomplete_init())});